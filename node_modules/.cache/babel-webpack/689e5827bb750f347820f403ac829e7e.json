{"ast":null,"code":"import { transferArrayItem } from '@angular/cdk/drag-drop';\nimport { TaskDialogComponent } from './task-dialog/task-dialog.component';\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/fire/firestore\";\nimport * as i3 from \"@angular/material/toolbar\";\nimport * as i4 from \"@angular/material/icon\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/cdk/drag-drop\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"./task/task.component\";\n\nfunction AppComponent_p_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 13);\n    i0.ɵɵtext(1, \"Empty list\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AppComponent_app_task_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-task\", 14);\n    i0.ɵɵlistener(\"edit\", function AppComponent_app_task_22_Template_app_task_edit_0_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.editTask(\"todo\", $event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const task_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"task\", task_r9);\n  }\n}\n\nfunction AppComponent_p_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 13);\n    i0.ɵɵtext(1, \"Empty list\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AppComponent_app_task_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-task\", 14);\n    i0.ɵɵlistener(\"edit\", function AppComponent_app_task_32_Template_app_task_edit_0_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.editTask(\"inProgress\", $event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const task_r12 = ctx.$implicit;\n    i0.ɵɵproperty(\"task\", task_r12);\n  }\n}\n\nfunction AppComponent_p_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 13);\n    i0.ɵɵtext(1, \"Empty list\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AppComponent_app_task_42_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-task\", 14);\n    i0.ɵɵlistener(\"edit\", function AppComponent_app_task_42_Template_app_task_edit_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.editTask(\"done\", $event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const task_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"task\", task_r15);\n  }\n}\n\nconst _c0 = function (a0, a1) {\n  return [a0, a1];\n};\n\nconst getObservable = collection => {\n  const subject = new BehaviorSubject([]);\n  collection.valueChanges({\n    idField: 'id'\n  }).subscribe(val => {\n    subject.next(val);\n  });\n  return subject;\n};\n\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    // injecting AngularFirestore in AppComponent's constructor\n    constructor(dialog, store) {\n      this.dialog = dialog;\n      this.store = store; // use angularFirestore to get the collection's content directly from the database.\n\n      this.todo = getObservable(this.store.collection('todo'));\n      this.inProgress = getObservable(this.store.collection('inProgress'));\n      this.done = getObservable(this.store.collection('done'));\n    } //edit method to edit tasks\n\n\n    editTask(list, task) {\n      const dialogRef = this.dialog.open(TaskDialogComponent, {\n        width: '270px',\n        data: {\n          task,\n          enableDelete: true\n        }\n      }); //delete the taks if the delete button clicked\n\n      dialogRef.afterClosed().subscribe(result => {\n        if (result.delete) {\n          //access the target task using firebase sdk and delete or update\n          this.store.collection(list).doc(task.id).delete();\n        } else {\n          this.store.collection(list).doc(task.id).update(task);\n        }\n      });\n    } //drop the list from taks when called\n\n\n    drop(event) {\n      if (event.previousContainer === event.container) {\n        return;\n      }\n\n      const item = event.previousContainer.data[event.previousIndex];\n      this.store.firestore.runTransaction(() => {\n        const promise = Promise.all([this.store.collection(event.previousContainer.id).doc(item.id).delete(), this.store.collection(event.container.id).add(item)]);\n        return promise;\n      });\n      transferArrayItem(event.previousContainer.data, event.container.data, event.previousIndex, event.currentIndex);\n    } //func to add a new task\n\n\n    newTask() {\n      const dialogRef = this.dialog.open(TaskDialogComponent, {\n        //open a dialog when user tries to add a new task\n        width: '270px',\n        data: {\n          task: {}\n        }\n      }); //add the new task to the to do list\n\n      dialogRef.afterClosed().subscribe(result => {\n        if (!result) {\n          return;\n        }\n\n        this.store.collection('todo').add(result.task);\n      });\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.AngularFirestore));\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 44,\n    vars: 39,\n    consts: [[\"color\", \"primary\"], [1, \"content-wrapper\"], [\"mat-button\", \"\", 3, \"click\"], [1, \"container-wrapper\"], [1, \"container\"], [\"cdkDropList\", \"\", \"id\", \"todo\", 1, \"list\", 3, \"cdkDropListData\", \"cdkDropListConnectedTo\", \"cdkDropListDropped\"], [\"todoList\", \"cdkDropList\"], [\"class\", \"empty-label\", 4, \"ngIf\"], [\"cdkDrag\", \"\", 3, \"task\", \"edit\", 4, \"ngFor\", \"ngForOf\"], [\"cdkDropList\", \"\", \"id\", \"inProgress\", 1, \"list\", 3, \"cdkDropListData\", \"cdkDropListConnectedTo\", \"cdkDropListDropped\"], [\"inProgressList\", \"cdkDropList\"], [\"cdkDropList\", \"\", \"id\", \"done\", 1, \"list\", 3, \"cdkDropListData\", \"cdkDropListConnectedTo\", \"cdkDropListDropped\"], [\"doneList\", \"cdkDropList\"], [1, \"empty-label\"], [\"cdkDrag\", \"\", 3, \"task\", \"edit\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"mat-toolbar\", 0);\n        i0.ɵɵelementStart(1, \"mat-icon\");\n        i0.ɵɵtext(2, \"local_fire_department\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"span\");\n        i0.ɵɵtext(4, \"Kanban Fire\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 1);\n        i0.ɵɵelementStart(6, \"button\", 2);\n        i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_6_listener() {\n          return ctx.newTask();\n        });\n        i0.ɵɵelementStart(7, \"mat-icon\");\n        i0.ɵɵtext(8, \"add\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(9, \" Add Task \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 3);\n        i0.ɵɵelementStart(11, \"div\", 4);\n        i0.ɵɵtext(12, \" ... \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 3);\n        i0.ɵɵelementStart(14, \"div\", 4);\n        i0.ɵɵelementStart(15, \"h2\");\n        i0.ɵɵtext(16, \"Backlog\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"mat-card\", 5, 6);\n        i0.ɵɵlistener(\"cdkDropListDropped\", function AppComponent_Template_mat_card_cdkDropListDropped_17_listener($event) {\n          return ctx.drop($event);\n        });\n        i0.ɵɵpipe(19, \"async\");\n        i0.ɵɵtemplate(20, AppComponent_p_20_Template, 2, 0, \"p\", 7);\n        i0.ɵɵpipe(21, \"async\");\n        i0.ɵɵtemplate(22, AppComponent_app_task_22_Template, 1, 1, \"app-task\", 8);\n        i0.ɵɵpipe(23, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"div\", 4);\n        i0.ɵɵelementStart(25, \"h2\");\n        i0.ɵɵtext(26, \"In progress\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"mat-card\", 9, 10);\n        i0.ɵɵlistener(\"cdkDropListDropped\", function AppComponent_Template_mat_card_cdkDropListDropped_27_listener($event) {\n          return ctx.drop($event);\n        });\n        i0.ɵɵpipe(29, \"async\");\n        i0.ɵɵtemplate(30, AppComponent_p_30_Template, 2, 0, \"p\", 7);\n        i0.ɵɵpipe(31, \"async\");\n        i0.ɵɵtemplate(32, AppComponent_app_task_32_Template, 1, 1, \"app-task\", 8);\n        i0.ɵɵpipe(33, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"div\", 4);\n        i0.ɵɵelementStart(35, \"h2\");\n        i0.ɵɵtext(36, \"Done\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"mat-card\", 11, 12);\n        i0.ɵɵlistener(\"cdkDropListDropped\", function AppComponent_Template_mat_card_cdkDropListDropped_37_listener($event) {\n          return ctx.drop($event);\n        });\n        i0.ɵɵpipe(39, \"async\");\n        i0.ɵɵtemplate(40, AppComponent_p_40_Template, 2, 0, \"p\", 7);\n        i0.ɵɵpipe(41, \"async\");\n        i0.ɵɵtemplate(42, AppComponent_app_task_42_Template, 1, 1, \"app-task\", 8);\n        i0.ɵɵpipe(43, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(18);\n\n        const _r3 = i0.ɵɵreference(28);\n\n        const _r6 = i0.ɵɵreference(38);\n\n        let tmp_2_0;\n        let tmp_6_0;\n        let tmp_10_0;\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"cdkDropListData\", i0.ɵɵpipeBind1(19, 12, ctx.todo))(\"cdkDropListConnectedTo\", i0.ɵɵpureFunction2(30, _c0, _r6, _r3));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ((tmp_2_0 = i0.ɵɵpipeBind1(21, 14, ctx.todo)) == null ? null : tmp_2_0.length) === 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(23, 16, ctx.todo));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"cdkDropListData\", i0.ɵɵpipeBind1(29, 18, ctx.inProgress))(\"cdkDropListConnectedTo\", i0.ɵɵpureFunction2(33, _c0, _r0, _r6));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ((tmp_6_0 = i0.ɵɵpipeBind1(31, 20, ctx.inProgress)) == null ? null : tmp_6_0.length) === 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(33, 22, ctx.inProgress));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"cdkDropListData\", i0.ɵɵpipeBind1(39, 24, ctx.done))(\"cdkDropListConnectedTo\", i0.ɵɵpureFunction2(36, _c0, _r0, _r3));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ((tmp_10_0 = i0.ɵɵpipeBind1(41, 26, ctx.done)) == null ? null : tmp_10_0.length) === 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(43, 28, ctx.done));\n      }\n    },\n    directives: [i3.MatToolbar, i4.MatIcon, i5.MatButton, i6.MatCard, i7.CdkDropList, i8.NgIf, i8.NgForOf, i9.TaskComponent, i7.CdkDrag],\n    pipes: [i8.AsyncPipe],\n    styles: [\"mat-toolbar[_ngcontent-%COMP%]{margin-bottom:20px}mat-toolbar[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin-left:10px}.content-wrapper[_ngcontent-%COMP%]{max-width:1400px;margin:auto}.container-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.container[_ngcontent-%COMP%]{width:400px;margin:0 25px 25px 0}.list[_ngcontent-%COMP%]{border:1px solid #ccc;min-height:60px;border-radius:4px}app-new-task[_ngcontent-%COMP%]{margin-bottom:30px}.empty-label[_ngcontent-%COMP%]{font-size:2em;padding-top:10px;text-align:center;opacity:.2}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}